<!doctype html>
<head><meta charset="utf-8"><meta property="og:image" content="https://tc39.es/ecmarkup/ecma-logo.png"><meta property="og:title" content="Joint Iteration"><meta property="og:description" content="Iterator.zip ( _iterables_ [ , _options_ ] )
  This method performs the following steps when called:
  
    1. If _iterables_ is not an Object, throw a *TypeError* exception.
    1. Set _options_ to ? GetOptionsObject(_options_).
    1. Let _mode_ be ? Get(_options_, *&quot;mode&quot;*).
    1. If _mode_ i">
<title>Joint Iteration</title><script src="ecmarkup.js?cache=0Y1yqwj_" defer=""></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.0.1/styles/base16/solarized-light.min.css"><link rel="stylesheet" href="ecmarkup.css"><link rel="stylesheet" href="print.css" media="print"><style>
    @media print {
      @page :left {
        @bottom-right {
          content: '© Ecma International 2025';
        }
      }
      @page :right {
        @bottom-left {
          content: '© Ecma International 2025';
        }
      }
      @page :first {
        @bottom-left {
          content: '';
        }
        @bottom-right {
          content: '';
        }
      }
      @page :blank {
        @bottom-left {
          content: '';
        }
        @bottom-right {
          content: '';
        }
      }
    }
    </style></head><body><div id="shortcuts-help">
<ul>
  <li><span>Toggle shortcuts help</span><code>?</code></li>
  <li><span>Toggle "can call user code" annotations</span><code>u</code></li>

  <li><span>Jump to search box</span><code>/</code></li>
  <li><span>Toggle pinning of the current clause</span><code>p</code></li>
  <li><span>Jump to <i>n</i>th pin</span><code>1-9</code></li>
</ul></div><div id="menu-toggle"><svg xmlns="http://www.w3.org/2000/svg" style="width:100%; height:100%; stroke:currentColor" viewBox="0 0 120 120" width="54" height="54">
      <title>Menu</title>
      <path stroke-width="10" stroke-linecap="round" d="M30,60 h60  M30,30 m0,5 h60  M30,90 m0,-5 h60"></path>
    </svg></div><div id="menu-spacer" class="menu-spacer"></div><div id="menu"><div id="menu-search"><input type="text" id="menu-search-box" placeholder="Search..."><div id="menu-search-results" class="inactive"></div></div><div id="menu-pins"><div class="menu-pane-header">Pins<button class="unpin-all">clear</button></div><ul id="menu-pins-list"></ul></div><div class="menu-pane-header">Table of Contents</div><div id="menu-toc"><ol class="toc"><li><span class="item-toggle-none"></span><a href="#sec-iterator.zip" title="Iterator.zip ( iterables [ , options ] )"><span class="secnum">1</span> Iterator.zip ( <var>iterables</var> [ , <var>options</var> ] )</a></li><li><span class="item-toggle-none"></span><a href="#sec-iterator.zipkeyed" title="Iterator.zipKeyed ( iterables [ , options ] )"><span class="secnum">2</span> Iterator.zipKeyed ( <var>iterables</var> [ , <var>options</var> ] )</a></li><li><span class="item-toggle-none"></span><a href="#sec-IteratorZip" title="IteratorZip ( iters, mode, padding, finishResults )"><span class="secnum">3</span> IteratorZip ( <var>iters</var>, <var>mode</var>, <var>padding</var>, <var>finishResults</var> )</a></li><li><span class="item-toggle-none"></span><a href="#sec-closeall" title="IteratorCloseAll ( iters, completion )"><span class="secnum">4</span> IteratorCloseAll ( <var>iters</var>, <var>completion</var> )</a></li><li><span class="item-toggle-none"></span><a href="#sec-ifabruptcloseiterators" title="IfAbruptCloseIterators ( value, iteratorRecords )"><span class="secnum">5</span> IfAbruptCloseIterators ( <var>value</var>, <var>iteratorRecords</var> )</a></li><li><span class="item-toggle-none"></span><a href="#sec-%iteratorhelperprototype%.return" title="%IteratorHelperPrototype%.return ( )"><span class="secnum">6</span> %IteratorHelperPrototype%.return ( )</a></li><li><span class="item-toggle">+</span><a href="#stolen-infra" title="Infra"><span class="secnum">7</span> Infra</a><ol class="toc"><li><span class="item-toggle-none"></span><a href="#sec-getoptionsobject" title="GetOptionsObject ( options )"><span class="secnum">7.1</span> GetOptionsObject ( <var>options</var> )</a></li></ol></li></ol></div></div><div id="spec-container"><h1 class="version">Stage 2.7 Draft / September 15, 2025</h1><h1 class="title">Joint Iteration</h1>

<emu-clause id="sec-iterator.zip">
  <h1><span class="secnum">1</span> Iterator.zip ( <var>iterables</var> [ , <var>options</var> ] )</h1>
  <p>This method performs the following steps when called:</p>
  <emu-alg><ol><li>If <var>iterables</var> <emu-xref href="#sec-object-type"><a href="https://tc39.es/ecma262/#sec-object-type">is not an Object</a></emu-xref>, throw a <emu-val>TypeError</emu-val> exception.</li><li>Set <var>options</var> to ?&nbsp;<emu-xref aoid="GetOptionsObject" id="_ref_0"><a href="#sec-getoptionsobject">GetOptionsObject</a></emu-xref>(<var>options</var>).</li><li>Let <var>mode</var> be ?&nbsp;<emu-xref aoid="Get"><a href="https://tc39.es/ecma262/#sec-get-o-p" class="e-user-code">Get</a></emu-xref>(<var>options</var>, <emu-val>"mode"</emu-val>).</li><li>If <var>mode</var> is <emu-val>undefined</emu-val>, set <var>mode</var> to <emu-val>"shortest"</emu-val>.</li><li>If <var>mode</var> is not one of <emu-val>"shortest"</emu-val>, <emu-val>"longest"</emu-val>, or <emu-val>"strict"</emu-val>, throw a <emu-val>TypeError</emu-val> exception.</li><li>Let <var>paddingOption</var> be <emu-val>undefined</emu-val>.</li><li>If <var>mode</var> is <emu-val>"longest"</emu-val>, then<ol><li>Set <var>paddingOption</var> to ?&nbsp;<emu-xref aoid="Get"><a href="https://tc39.es/ecma262/#sec-get-o-p" class="e-user-code">Get</a></emu-xref>(<var>options</var>, <emu-val>"padding"</emu-val>).</li><li>If <var>paddingOption</var> is not <emu-val>undefined</emu-val> and <var>paddingOption</var> <emu-xref href="#sec-object-type"><a href="https://tc39.es/ecma262/#sec-object-type">is not an Object</a></emu-xref>, throw a <emu-val>TypeError</emu-val> exception.</li></ol></li><li>Let <var>iters</var> be a new empty <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.es/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref>.</li><li>Let <var>padding</var> be a new empty <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.es/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref>.</li><li>Let <var>inputIter</var> be ?&nbsp;<emu-xref aoid="GetIterator"><a href="https://tc39.es/ecma262/#sec-getiterator" class="e-user-code">GetIterator</a></emu-xref>(<var>iterables</var>, <emu-const>sync</emu-const>).</li><li>Let <var>next</var> be <emu-const>not-started</emu-const>.</li><li>Repeat, while <var>next</var> is not <emu-const>done</emu-const>,<ol><li>Set <var>next</var> to <emu-xref aoid="Completion"><a href="https://tc39.es/ecma262/#sec-completion-ao">Completion</a></emu-xref>(<emu-xref aoid="IteratorStepValue"><a href="https://tc39.es/ecma262/#sec-iteratorstepvalue" class="e-user-code">IteratorStepValue</a></emu-xref>(<var>inputIter</var>)).</li><li><emu-xref aoid="IfAbruptCloseIterators" id="_ref_1"><a href="#sec-ifabruptcloseiterators" class="e-user-code">IfAbruptCloseIterators</a></emu-xref>(<var>next</var>, <var>iters</var>).</li><li>If <var>next</var> is not <emu-const>done</emu-const>, then<ol><li>Let <var>iter</var> be <emu-xref aoid="Completion"><a href="https://tc39.es/ecma262/#sec-completion-ao">Completion</a></emu-xref>(<emu-xref aoid="GetIteratorFlattenable"><a href="https://tc39.es/proposal-iterator-helpers#sec-getiteratorflattenable" class="e-user-code">GetIteratorFlattenable</a></emu-xref>(<var>next</var>, <emu-const>reject-strings</emu-const>)).</li><li><emu-xref aoid="IfAbruptCloseIterators" id="_ref_2"><a href="#sec-ifabruptcloseiterators" class="e-user-code">IfAbruptCloseIterators</a></emu-xref>(<var>iter</var>, the <emu-xref href="#list-concatenation"><a href="https://tc39.es/ecma262/#list-concatenation">list-concatenation</a></emu-xref> of « <var>inputIter</var>&nbsp;» and <var>iters</var>).</li><li>Append <var>iter</var> to <var>iters</var>.</li></ol></li></ol></li><li>Let <var>iterCount</var> be the number of elements in <var>iters</var>.</li><li>If <var>mode</var> is <emu-val>"longest"</emu-val>, then<ol><li>If <var>paddingOption</var> is <emu-val>undefined</emu-val>, then<ol><li>Perform the following steps <var>iterCount</var> times:<ol><li>Append <emu-val>undefined</emu-val> to <var>padding</var>.</li></ol></li></ol></li><li>Else,<ol><li>Let <var>paddingIter</var> be <emu-xref aoid="Completion"><a href="https://tc39.es/ecma262/#sec-completion-ao">Completion</a></emu-xref>(<emu-xref aoid="GetIterator"><a href="https://tc39.es/ecma262/#sec-getiterator" class="e-user-code">GetIterator</a></emu-xref>(<var>paddingOption</var>, <emu-const>sync</emu-const>)).</li><li><emu-xref aoid="IfAbruptCloseIterators" id="_ref_3"><a href="#sec-ifabruptcloseiterators" class="e-user-code">IfAbruptCloseIterators</a></emu-xref>(<var>paddingIter</var>, <var>iters</var>).</li><li>Let <var>usingIterator</var> be <emu-val>true</emu-val>.</li><li>Perform the following steps <var>iterCount</var> times:<ol><li>If <var>usingIterator</var> is <emu-val>true</emu-val>, then<ol><li>Set <var>next</var> to <emu-xref aoid="Completion"><a href="https://tc39.es/ecma262/#sec-completion-ao">Completion</a></emu-xref>(<emu-xref aoid="IteratorStepValue"><a href="https://tc39.es/ecma262/#sec-iteratorstepvalue" class="e-user-code">IteratorStepValue</a></emu-xref>(<var>paddingIter</var>)).</li><li><emu-xref aoid="IfAbruptCloseIterators" id="_ref_4"><a href="#sec-ifabruptcloseiterators" class="e-user-code">IfAbruptCloseIterators</a></emu-xref>(<var>next</var>, <var>iters</var>).</li><li>If <var>next</var> is <emu-const>done</emu-const>, then<ol><li>Set <var>usingIterator</var> to <emu-val>false</emu-val>.</li></ol></li><li>Else,<ol><li>Append <var>next</var> to <var>padding</var>.</li></ol></li></ol></li><li>If <var>usingIterator</var> is <emu-val>false</emu-val>, append <emu-val>undefined</emu-val> to <var>padding</var>.</li></ol></li><li>If <var>usingIterator</var> is <emu-val>true</emu-val>, then<ol><li>Let <var>completion</var> be <emu-xref aoid="Completion"><a href="https://tc39.es/ecma262/#sec-completion-ao">Completion</a></emu-xref>(<emu-xref aoid="IteratorClose"><a href="https://tc39.es/ecma262/#sec-iteratorclose" class="e-user-code">IteratorClose</a></emu-xref>(<var>paddingIter</var>, <emu-xref aoid="NormalCompletion"><a href="https://tc39.es/ecma262/#sec-normalcompletion">NormalCompletion</a></emu-xref>(<emu-const>unused</emu-const>))).</li><li><emu-xref aoid="IfAbruptCloseIterators" id="_ref_5"><a href="#sec-ifabruptcloseiterators" class="e-user-code">IfAbruptCloseIterators</a></emu-xref>(<var>completion</var>, <var>iters</var>).</li></ol></li></ol></li></ol></li><li>Let <var>finishResults</var> be a new <emu-xref href="#sec-abstract-closure"><a href="https://tc39.es/ecma262/#sec-abstract-closure">Abstract Closure</a></emu-xref> with parameters (<var>results</var>) that captures nothing and performs the following steps when called:<ol><li>Return <emu-xref aoid="CreateArrayFromList"><a href="https://tc39.es/ecma262/#sec-createarrayfromlist">CreateArrayFromList</a></emu-xref>(<var>results</var>).</li></ol></li><li>Return <emu-xref aoid="IteratorZip" id="_ref_6"><a href="#sec-IteratorZip">IteratorZip</a></emu-xref>(<var>iters</var>, <var>mode</var>, <var>padding</var>, <var>finishResults</var>).</li></ol></emu-alg>
</emu-clause>

<emu-clause id="sec-iterator.zipkeyed">
  <h1><span class="secnum">2</span> Iterator.zipKeyed ( <var>iterables</var> [ , <var>options</var> ] )</h1>
  <p>This method performs the following steps when called:</p>
  <emu-alg><ol><li>If <var>iterables</var> <emu-xref href="#sec-object-type"><a href="https://tc39.es/ecma262/#sec-object-type">is not an Object</a></emu-xref>, throw a <emu-val>TypeError</emu-val> exception.</li><li>Set <var>options</var> to ?&nbsp;<emu-xref aoid="GetOptionsObject" id="_ref_7"><a href="#sec-getoptionsobject">GetOptionsObject</a></emu-xref>(<var>options</var>).</li><li>Let <var>mode</var> be ?&nbsp;<emu-xref aoid="Get"><a href="https://tc39.es/ecma262/#sec-get-o-p" class="e-user-code">Get</a></emu-xref>(<var>options</var>, <emu-val>"mode"</emu-val>).</li><li>If <var>mode</var> is <emu-val>undefined</emu-val>, set <var>mode</var> to <emu-val>"shortest"</emu-val>.</li><li>If <var>mode</var> is not one of <emu-val>"shortest"</emu-val>, <emu-val>"longest"</emu-val>, or <emu-val>"strict"</emu-val>, throw a <emu-val>TypeError</emu-val> exception.</li><li>Let <var>paddingOption</var> be <emu-val>undefined</emu-val>.</li><li>If <var>mode</var> is <emu-val>"longest"</emu-val>, then<ol><li>Set <var>paddingOption</var> to ?&nbsp;<emu-xref aoid="Get"><a href="https://tc39.es/ecma262/#sec-get-o-p" class="e-user-code">Get</a></emu-xref>(<var>options</var>, <emu-val>"padding"</emu-val>).</li><li>If <var>paddingOption</var> is not <emu-val>undefined</emu-val> and <var>paddingOption</var> <emu-xref href="#sec-object-type"><a href="https://tc39.es/ecma262/#sec-object-type">is not an Object</a></emu-xref>, throw a <emu-val>TypeError</emu-val> exception.</li></ol></li><li>Let <var>iters</var> be a new empty <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.es/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref>.</li><li>Let <var>padding</var> be a new empty <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.es/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref>.</li><li>Let <var>allKeys</var> be ?&nbsp;<var>iterables</var>.<var class="field">[[OwnPropertyKeys]]</var>().</li><li>Let <var>keys</var> be a new empty <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.es/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref>.</li><li>For each element <var>key</var> of <var>allKeys</var>, do<ol><li>Let <var>desc</var> be <emu-xref aoid="Completion"><a href="https://tc39.es/ecma262/#sec-completion-ao">Completion</a></emu-xref>(<var>iterables</var>.<var class="field">[[GetOwnProperty]]</var>(<var>key</var>)).</li><li><emu-xref aoid="IfAbruptCloseIterators" id="_ref_8"><a href="#sec-ifabruptcloseiterators" class="e-user-code">IfAbruptCloseIterators</a></emu-xref>(<var>desc</var>, <var>iters</var>).</li><li>If <var>desc</var> is not <emu-val>undefined</emu-val> and <var>desc</var>.<var class="field">[[Enumerable]]</var> is <emu-val>true</emu-val>, then<ol><li>Let <var>value</var> be <emu-xref aoid="Completion"><a href="https://tc39.es/ecma262/#sec-completion-ao">Completion</a></emu-xref>(<emu-xref aoid="Get"><a href="https://tc39.es/ecma262/#sec-get-o-p" class="e-user-code">Get</a></emu-xref>(<var>iterables</var>, <var>key</var>)).</li><li><emu-xref aoid="IfAbruptCloseIterators" id="_ref_9"><a href="#sec-ifabruptcloseiterators" class="e-user-code">IfAbruptCloseIterators</a></emu-xref>(<var>value</var>, <var>iters</var>).</li><li>If <var>value</var> is not <emu-val>undefined</emu-val>, then<ol><li>Append <var>key</var> to <var>keys</var>.</li><li>Let <var>iter</var> be <emu-xref aoid="Completion"><a href="https://tc39.es/ecma262/#sec-completion-ao">Completion</a></emu-xref>(<emu-xref aoid="GetIteratorFlattenable"><a href="https://tc39.es/proposal-iterator-helpers#sec-getiteratorflattenable" class="e-user-code">GetIteratorFlattenable</a></emu-xref>(<var>value</var>, <emu-const>reject-strings</emu-const>)).</li><li><emu-xref aoid="IfAbruptCloseIterators" id="_ref_10"><a href="#sec-ifabruptcloseiterators" class="e-user-code">IfAbruptCloseIterators</a></emu-xref>(<var>iter</var>, <var>iters</var>).</li><li>Append <var>iter</var> to <var>iters</var>.</li></ol></li></ol></li></ol></li><li>Let <var>iterCount</var> be the number of elements in <var>iters</var>.</li><li>If <var>mode</var> is <emu-val>"longest"</emu-val>, then<ol><li>If <var>paddingOption</var> is <emu-val>undefined</emu-val>, then<ol><li>Perform the following steps <var>iterCount</var> times:<ol><li>Append <emu-val>undefined</emu-val> to <var>padding</var>.</li></ol></li></ol></li><li>Else,<ol><li>For each element <var>key</var> of <var>keys</var>, do<ol><li>Let <var>value</var> be <emu-xref aoid="Completion"><a href="https://tc39.es/ecma262/#sec-completion-ao">Completion</a></emu-xref>(<emu-xref aoid="Get"><a href="https://tc39.es/ecma262/#sec-get-o-p" class="e-user-code">Get</a></emu-xref>(<var>paddingOption</var>, <var>key</var>)).</li><li><emu-xref aoid="IfAbruptCloseIterators" id="_ref_11"><a href="#sec-ifabruptcloseiterators" class="e-user-code">IfAbruptCloseIterators</a></emu-xref>(<var>value</var>, <var>iters</var>).</li><li>Append <var>value</var> to <var>padding</var>.</li></ol></li></ol></li></ol></li><li>Let <var>finishResults</var> be a new <emu-xref href="#sec-abstract-closure"><a href="https://tc39.es/ecma262/#sec-abstract-closure">Abstract Closure</a></emu-xref> with parameters (<var>results</var>) that captures <var>keys</var> and <var>iterCount</var> and performs the following steps when called:<ol><li>Let <var>obj</var> be <emu-xref aoid="OrdinaryObjectCreate"><a href="https://tc39.es/ecma262/#sec-ordinaryobjectcreate">OrdinaryObjectCreate</a></emu-xref>(<emu-val>null</emu-val>).</li><li>For each <emu-xref href="#integer"><a href="https://tc39.es/ecma262/#integer">integer</a></emu-xref> <var>i</var> such that 0 ≤ <var>i</var> &lt; <var>iterCount</var>, in ascending order, do<ol><li>Perform !&nbsp;<emu-xref aoid="CreateDataPropertyOrThrow"><a href="https://tc39.es/ecma262/#sec-createdatapropertyorthrow">CreateDataPropertyOrThrow</a></emu-xref>(<var>obj</var>, <var>keys</var>[<var>i</var>], <var>results</var>[<var>i</var>]).</li></ol></li><li>Return <var>obj</var>.</li></ol></li><li>Return <emu-xref aoid="IteratorZip" id="_ref_12"><a href="#sec-IteratorZip">IteratorZip</a></emu-xref>(<var>iters</var>, <var>mode</var>, <var>padding</var>, <var>finishResults</var>).</li></ol></emu-alg>
</emu-clause>

<emu-clause id="sec-IteratorZip" type="abstract operation" aoid="IteratorZip">
  <h1><span class="secnum">3</span> IteratorZip ( <var>iters</var>, <var>mode</var>, <var>padding</var>, <var>finishResults</var> )</h1>
  <p>The abstract operation IteratorZip takes arguments <var>iters</var> (a <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.es/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref> of <emu-xref href="#sec-iterator-records"><a href="https://tc39.es/ecma262/#sec-iterator-records">Iterator Records</a></emu-xref>), <var>mode</var> (either <emu-val>"shortest"</emu-val>, <emu-val>"longest"</emu-val>, or <emu-val>"strict"</emu-val>), <var>padding</var> (a <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.es/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref> of <emu-xref href="#sec-ecmascript-language-types"><a href="https://tc39.es/ecma262/#sec-ecmascript-language-types">ECMAScript language values</a></emu-xref>), and <var>finishResults</var> (an <emu-xref href="#sec-abstract-closure"><a href="https://tc39.es/ecma262/#sec-abstract-closure">Abstract Closure</a></emu-xref> that takes a <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.es/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref> of ECMAScript values and returns an ECMAScript value) and returns a Generator. It performs the following steps when called:</p>
  <emu-alg><ol><li>Let <var>iterCount</var> be the number of elements in <var>iters</var>.</li><li>Let <var>openIters</var> be a copy of <var>iters</var>.</li><li>Let <var>closure</var> be a new <emu-xref href="#sec-abstract-closure"><a href="https://tc39.es/ecma262/#sec-abstract-closure">Abstract Closure</a></emu-xref> with no parameters that captures <var>iters</var>, <var>iterCount</var>, <var>openIters</var>, <var>mode</var>, <var>padding</var>, and <var>finishResults</var>, and performs the following steps when called:<ol><li>If <var>iterCount</var> = 0, return <emu-xref aoid="ReturnCompletion"><a href="https://tc39.es/ecma262/#sec-returncompletion">ReturnCompletion</a></emu-xref>(<emu-val>undefined</emu-val>).</li><li>Repeat,<ol><li>Let <var>results</var> be a new empty <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.es/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref>.</li><li><emu-xref href="#assert"><a href="https://tc39.es/ecma262/#assert">Assert</a></emu-xref>: <var>openIters</var> is not empty.</li><li>For each <emu-xref href="#integer"><a href="https://tc39.es/ecma262/#integer">integer</a></emu-xref> <var>i</var> such that 0 ≤ <var>i</var> &lt; <var>iterCount</var>, in ascending order, do<ol><li>Let <var>iter</var> be <var>iters</var>[<var>i</var>].</li><li>If <var>iter</var> is <emu-val>null</emu-val>, then<ol><li><emu-xref href="#assert"><a href="https://tc39.es/ecma262/#assert">Assert</a></emu-xref>: <var>mode</var> is <emu-val>"longest"</emu-val>.</li><li>Let <var>result</var> be <var>padding</var>[<var>i</var>].</li></ol></li><li>Else,<ol><li>Let <var>result</var> be <emu-xref aoid="Completion"><a href="https://tc39.es/ecma262/#sec-completion-ao">Completion</a></emu-xref>(<emu-xref aoid="IteratorStepValue"><a href="https://tc39.es/ecma262/#sec-iteratorstepvalue" class="e-user-code">IteratorStepValue</a></emu-xref>(<var>iter</var>)).</li><li>If <var>result</var> is an <emu-xref href="#sec-completion-record-specification-type"><a href="https://tc39.es/ecma262/#sec-completion-record-specification-type">abrupt completion</a></emu-xref>, then<ol><li>Remove <var>iter</var> from <var>openIters</var>.</li><li>Return ?&nbsp;<emu-xref aoid="IteratorCloseAll" id="_ref_13"><a href="#sec-closeall" class="e-user-code">IteratorCloseAll</a></emu-xref>(<var>openIters</var>, <var>result</var>).</li></ol></li><li>Set <var>result</var> to !&nbsp;<var>result</var>.</li><li>If <var>result</var> is <emu-const>done</emu-const>, then<ol><li>Remove <var>iter</var> from <var>openIters</var>.</li><li>If <var>mode</var> is <emu-val>"shortest"</emu-val>, then<ol><li>Return ?&nbsp;<emu-xref aoid="IteratorCloseAll" id="_ref_14"><a href="#sec-closeall" class="e-user-code">IteratorCloseAll</a></emu-xref>(<var>openIters</var>, <emu-xref aoid="ReturnCompletion"><a href="https://tc39.es/ecma262/#sec-returncompletion">ReturnCompletion</a></emu-xref>(<emu-val>undefined</emu-val>)).</li></ol></li><li>Else if <var>mode</var> is <emu-val>"strict"</emu-val>, then<ol><li>If <var>i</var> ≠ 0, then<ol><li>Return ?&nbsp;<emu-xref aoid="IteratorCloseAll" id="_ref_15"><a href="#sec-closeall" class="e-user-code">IteratorCloseAll</a></emu-xref>(<var>openIters</var>, <emu-xref aoid="ThrowCompletion"><a href="https://tc39.es/ecma262/#sec-throwcompletion">ThrowCompletion</a></emu-xref>(a newly created <emu-val>TypeError</emu-val> object)).</li></ol></li><li>For each <emu-xref href="#integer"><a href="https://tc39.es/ecma262/#integer">integer</a></emu-xref> <var>k</var> such that 1 ≤ <var>k</var> &lt; <var>iterCount</var>, in ascending order, do<ol><li><emu-xref href="#assert"><a href="https://tc39.es/ecma262/#assert">Assert</a></emu-xref>: <var>iters</var>[<var>k</var>] is not <emu-val>null</emu-val>.</li><li>Let <var>open</var> be <emu-xref aoid="Completion"><a href="https://tc39.es/ecma262/#sec-completion-ao">Completion</a></emu-xref>(<emu-xref aoid="IteratorStep"><a href="https://tc39.es/ecma262/#sec-iteratorstep" class="e-user-code">IteratorStep</a></emu-xref>(<var>iters</var>[<var>k</var>])).</li><li>If <var>open</var> is an <emu-xref href="#sec-completion-record-specification-type"><a href="https://tc39.es/ecma262/#sec-completion-record-specification-type">abrupt completion</a></emu-xref>, then<ol><li>Remove <var>iters</var>[<var>k</var>] from <var>openIters</var>.</li><li>Return ?&nbsp;<emu-xref aoid="IteratorCloseAll" id="_ref_16"><a href="#sec-closeall" class="e-user-code">IteratorCloseAll</a></emu-xref>(<var>openIters</var>, <var>open</var>).</li></ol></li><li>Set <var>open</var> to !&nbsp;<var>open</var>.</li><li>If <var>open</var> is <emu-const>done</emu-const>, then<ol><li>Remove <var>iters</var>[<var>k</var>] from <var>openIters</var>.</li></ol></li><li>Else,<ol><li>Return ?&nbsp;<emu-xref aoid="IteratorCloseAll" id="_ref_17"><a href="#sec-closeall" class="e-user-code">IteratorCloseAll</a></emu-xref>(<var>openIters</var>, <emu-xref aoid="ThrowCompletion"><a href="https://tc39.es/ecma262/#sec-throwcompletion">ThrowCompletion</a></emu-xref>(a newly created <emu-val>TypeError</emu-val> object)).</li></ol></li></ol></li><li>Return <emu-xref aoid="ReturnCompletion"><a href="https://tc39.es/ecma262/#sec-returncompletion">ReturnCompletion</a></emu-xref>(<emu-val>undefined</emu-val>).</li></ol></li><li>Else,<ol><li><emu-xref href="#assert"><a href="https://tc39.es/ecma262/#assert">Assert</a></emu-xref>: <var>mode</var> is <emu-val>"longest"</emu-val>.</li><li>If <var>openIters</var> is empty, return <emu-xref aoid="ReturnCompletion"><a href="https://tc39.es/ecma262/#sec-returncompletion">ReturnCompletion</a></emu-xref>(<emu-val>undefined</emu-val>).</li><li>Set <var>iters</var>[<var>i</var>] to <emu-val>null</emu-val>.</li><li>Set <var>result</var> to <var>padding</var>[<var>i</var>].</li></ol></li></ol></li></ol></li><li>Append <var>result</var> to <var>results</var>.</li></ol></li><li>Set <var>results</var> to <var>finishResults</var>(<var>results</var>).</li><li>Let <var>completion</var> be <emu-xref aoid="Completion"><a href="https://tc39.es/ecma262/#sec-completion-ao">Completion</a></emu-xref>(<emu-xref aoid="Yield"><a href="https://tc39.es/ecma262/#sec-yield" class="e-user-code">Yield</a></emu-xref>(<var>results</var>)).</li><li>If <var>completion</var> is an <emu-xref href="#sec-completion-record-specification-type"><a href="https://tc39.es/ecma262/#sec-completion-record-specification-type">abrupt completion</a></emu-xref>, then<ol><li>Return ?&nbsp;<emu-xref aoid="IteratorCloseAll" id="_ref_18"><a href="#sec-closeall" class="e-user-code">IteratorCloseAll</a></emu-xref>(<var>openIters</var>, <var>completion</var>).</li></ol></li></ol></li></ol></li><li>Let <var>gen</var> be <emu-xref aoid="CreateIteratorFromClosure"><a href="https://tc39.es/proposal-iterator-helpers#sec-createiteratorfromclosure">CreateIteratorFromClosure</a></emu-xref>(<var>closure</var>, <emu-val>"Iterator Helper"</emu-val>, <emu-xref href="#sec-%iteratorhelperprototype%-object"><a href="https://tc39.es/proposal-iterator-helpers#sec-%iteratorhelperprototype%-object">%IteratorHelperPrototype%</a></emu-xref>, « <var class="field">[[UnderlyingIterators]]</var>&nbsp;»).</li><li>Set <var>gen</var>.<var class="field">[[UnderlyingIterators]]</var> to <var>openIters</var>.</li><li>Return <var>gen</var>.</li></ol></emu-alg>
</emu-clause>

<emu-clause id="sec-closeall" type="abstract operation" aoid="IteratorCloseAll">
  <h1><span class="secnum">4</span> IteratorCloseAll ( <var>iters</var>, <var>completion</var> )</h1>
  <p>The abstract operation IteratorCloseAll takes arguments <var>iters</var> (a <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.es/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref> of <emu-xref href="#sec-iterator-records"><a href="https://tc39.es/ecma262/#sec-iterator-records">Iterator Records</a></emu-xref>) and <var>completion</var> (a <emu-xref href="#sec-completion-record-specification-type"><a href="https://tc39.es/ecma262/#sec-completion-record-specification-type">Completion Record</a></emu-xref>) and returns a <emu-xref href="#sec-completion-record-specification-type"><a href="https://tc39.es/ecma262/#sec-completion-record-specification-type">Completion Record</a></emu-xref>. It performs the following steps when called:</p>
  <emu-alg><ol><li>For each element <var>iter</var> of <var>iters</var>, in reverse <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.es/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref> order, do<ol><li>Set <var>completion</var> to <emu-xref aoid="Completion"><a href="https://tc39.es/ecma262/#sec-completion-ao">Completion</a></emu-xref>(<emu-xref aoid="IteratorClose"><a href="https://tc39.es/ecma262/#sec-iteratorclose" class="e-user-code">IteratorClose</a></emu-xref>(<var>iter</var>, <var>completion</var>)).</li></ol></li><li>Return ?&nbsp;<var>completion</var>.</li></ol></emu-alg>
</emu-clause>

<emu-clause id="sec-ifabruptcloseiterators" aoid="IfAbruptCloseIterators">
  <h1><span class="secnum">5</span> IfAbruptCloseIterators ( <var>value</var>, <var>iteratorRecords</var> )</h1>
  <p>IfAbruptCloseIterators is a shorthand for a sequence of algorithm steps that use a list of <emu-xref href="#sec-iterator-records"><a href="https://tc39.es/ecma262/#sec-iterator-records">Iterator Records</a></emu-xref>. An algorithm step of the form:</p>
  <emu-alg><ol><li><emu-xref aoid="IfAbruptCloseIterators" id="_ref_19"><a href="#sec-ifabruptcloseiterators" class="e-user-code">IfAbruptCloseIterators</a></emu-xref>(<var>value</var>, <var>iteratorRecords</var>).</li></ol></emu-alg>
  <p>means the same thing as:</p>
  <emu-alg><ol><li><emu-xref href="#assert"><a href="https://tc39.es/ecma262/#assert">Assert</a></emu-xref>: <var>value</var> is a <emu-xref href="#sec-completion-record-specification-type"><a href="https://tc39.es/ecma262/#sec-completion-record-specification-type">Completion Record</a></emu-xref>.</li><li>If <var>value</var> is an <emu-xref href="#sec-completion-record-specification-type"><a href="https://tc39.es/ecma262/#sec-completion-record-specification-type">abrupt completion</a></emu-xref>, return ?&nbsp;<emu-xref aoid="IteratorCloseAll" id="_ref_20"><a href="#sec-closeall" class="e-user-code">IteratorCloseAll</a></emu-xref>(<var>iteratorRecords</var>, <var>value</var>).</li><li>Else, set <var>value</var> to <var>value</var>.<var class="field">[[Value]]</var>.</li></ol></emu-alg>
</emu-clause>

<emu-clause id="sec-%iteratorhelperprototype%.return">
  <h1><span class="secnum">6</span> %IteratorHelperPrototype%.return ( )</h1>
  <emu-alg><ol><li>Let <var>O</var> be <emu-val>this</emu-val> value.</li><li><del>Perform ?&nbsp;<emu-xref aoid="RequireInternalSlot"><a href="https://tc39.es/ecma262/#sec-requireinternalslot">RequireInternalSlot</a></emu-xref>(<var>O</var>, <var class="field">[[UnderlyingIterator]]</var>).</del></li><li><ins>Perform ?&nbsp;<emu-xref aoid="RequireInternalSlot"><a href="https://tc39.es/ecma262/#sec-requireinternalslot">RequireInternalSlot</a></emu-xref>(<var>O</var>, <var class="field">[[UnderlyingIterators]]</var>).</ins></li><li><emu-xref href="#assert"><a href="https://tc39.es/ecma262/#assert">Assert</a></emu-xref>: <var>O</var> has a <var class="field">[[GeneratorState]]</var> slot.</li><li>If <var>O</var>.<var class="field">[[GeneratorState]]</var> is <emu-const>suspended-start</emu-const>, then<ol><li>Set <var>O</var>.<var class="field">[[GeneratorState]]</var> to <emu-const>completed</emu-const>.</li><li>NOTE: Once a generator enters the completed state it never leaves it and its associated <emu-xref href="#sec-execution-contexts"><a href="https://tc39.es/ecma262/#sec-execution-contexts">execution context</a></emu-xref> is never resumed. Any execution state associated with <var>O</var> can be discarded at this point.</li><li><del>Perform ?&nbsp;<emu-xref aoid="IteratorClose"><a href="https://tc39.es/ecma262/#sec-iteratorclose" class="e-user-code">IteratorClose</a></emu-xref>(<var>O</var>.<var class="field">[[UnderlyingIterator]]</var>, <emu-xref aoid="ReturnCompletion"><a href="https://tc39.es/ecma262/#sec-returncompletion">ReturnCompletion</a></emu-xref>(<emu-val>undefined</emu-val>)).</del></li><li><ins>Perform ?&nbsp;<emu-xref aoid="IteratorCloseAll" id="_ref_21"><a href="#sec-closeall" class="e-user-code">IteratorCloseAll</a></emu-xref>(<var>O</var>.<var class="field">[[UnderlyingIterators]]</var>, <emu-xref aoid="ReturnCompletion"><a href="https://tc39.es/ecma262/#sec-returncompletion">ReturnCompletion</a></emu-xref>(<emu-val>undefined</emu-val>)).</ins></li><li>Return <emu-xref aoid="CreateIteratorResultObject"><a href="https://tc39.es/ecma262/#sec-createiterresultobject">CreateIteratorResultObject</a></emu-xref>(<emu-val>undefined</emu-val>, <emu-val>true</emu-val>).</li></ol></li><li>Let <var>C</var> be <emu-xref aoid="Completion"><a href="https://tc39.es/ecma262/#sec-completion-ao">Completion</a></emu-xref> { <var class="field">[[Type]]</var>: <emu-const>return</emu-const>, <var class="field">[[Value]]</var>: <emu-val>undefined</emu-val>, <var class="field">[[Target]]</var>: <emu-const>empty</emu-const>&nbsp;}.</li><li>Return ?&nbsp;<emu-xref aoid="GeneratorResumeAbrupt"><a href="https://tc39.es/ecma262/#sec-generatorresumeabrupt" class="e-user-code">GeneratorResumeAbrupt</a></emu-xref>(<var>O</var>, <var>C</var>, <emu-val>"Iterator Helper"</emu-val>).</li></ol></emu-alg>
</emu-clause>

<emu-clause id="stolen-infra">
  <h1><span class="secnum">7</span> Infra</h1>

  <emu-note><span class="note">Note</span><div class="note-contents">
    <p>
      These AOs are taken from ecma402 and are listed here because they will need to move to ecma262. This is the first API in ecma262 that will take an options bag.
    </p>
  </div></emu-note>

  <emu-clause id="sec-getoptionsobject" type="abstract operation" aoid="GetOptionsObject">
    <h1><span class="secnum">7.1</span> GetOptionsObject ( <var>options</var> )</h1>
    <p>The abstract operation GetOptionsObject takes argument <var>options</var> (an <emu-xref href="#sec-ecmascript-language-types"><a href="https://tc39.es/ecma262/#sec-ecmascript-language-types">ECMAScript language value</a></emu-xref>) and returns either a <emu-xref href="#sec-completion-record-specification-type"><a href="https://tc39.es/ecma262/#sec-completion-record-specification-type">normal completion containing</a></emu-xref> an Object or a <emu-xref href="#sec-completion-record-specification-type"><a href="https://tc39.es/ecma262/#sec-completion-record-specification-type">throw completion</a></emu-xref>. 
        It returns an Object suitable for use with GetOption, either <var>options</var> itself or a default empty Object.
        It throws a <emu-val>TypeError</emu-val> if <var>options</var> is not <emu-val>undefined</emu-val> and not an Object.
       It performs the following steps when called:</p>
    <emu-alg><ol><li>If <var>options</var> is <emu-val>undefined</emu-val>, then<ol><li>Return <emu-xref aoid="OrdinaryObjectCreate"><a href="https://tc39.es/ecma262/#sec-ordinaryobjectcreate">OrdinaryObjectCreate</a></emu-xref>(<emu-val>null</emu-val>).</li></ol></li><li>If <var>options</var> <emu-xref href="#sec-object-type"><a href="https://tc39.es/ecma262/#sec-object-type">is an Object</a></emu-xref>, then<ol><li>Return <var>options</var>.</li></ol></li><li>Throw a <emu-val>TypeError</emu-val> exception.</li></ol></emu-alg>
  </emu-clause>
</emu-clause>

</div></body>